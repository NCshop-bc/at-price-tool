<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>NCå°ˆè³£åº— - è²“å’ªå¤§æˆ°çˆ­ è‡ªå‹•å ±åƒ¹å·¥å…·</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      background-color: #111;
      color: #eee;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }
    th, td {
      padding: 8px;
      text-align: center;
      border: 1px solid #444;
    }
    input {
      width: 80px;
      padding: 5px;
      background-color: #222;
      color: #eee;
      border: 1px solid #555;
      text-align: center;
    }
    button {
      padding: 10px 20px;
      background-color: #333;
      color: #fff;
      border: 1px solid #555;
      cursor: pointer;
      margin-top: 10px;
    }
    button:hover {
      background-color: #444;
    }
    pre {
      background: #222;
      padding: 15px;
      border-radius: 5px;
      color: #0f0;
      white-space: pre-wrap;
    }
    #copyToast {
      position: fixed;
      top: 20px;
      right: 20px;
      background-color: #0f0;
      color: #000;
      padding: 10px 20px;
      border-radius: 5px;
      display: none;
      z-index: 9999;
      font-weight: bold;
    }
    .confetti {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 9998;
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
</head>
<body>
  <h1>NCå°ˆè³£åº— - è²“å’ªå¤§æˆ°çˆ­ è‡ªå‹•å ±åƒ¹å·¥å…·</h1>
  <table>
    <thead>
      <tr>
        <th>å•†å“</th>
        <th>ä»½æ•¸</th>
        <th>å¼µæ•¸ / é¡†æ•¸ / å€‹æ•¸</th>
      </tr>
    </thead>
    <tbody id="itemTable"></tbody>
  </table>
  <button onclick="calculateTotal()">è¨ˆç®—ç¸½é‡‘é¡</button>
  <h2>å ±åƒ¹çµæœï¼š</h2>
  <pre id="output"></pre>
  <div id="copyToast">âœ… å·²è¤‡è£½å ±åƒ¹åˆ°å‰ªè²¼ç°¿</div>

<script>
  const priceTable = {
    '1å„„å· 1å¼µ': { unit: 1, price: 1 },
    'éŠ€å· 300å¼µ': { unit: 300, price: 10 },
    'é‡‘å· 150å¼µ': { unit: 150, price: 10 },
    'ç™½é‡‘å· 3å¼µ': { unit: 3, price: 10 },
    'å‚³èªªå· 1å¼µ': { unit: 1, price: 10 },
    'é¦–é ˜æ—— 200å€‹': { unit: 200, price: 10, roundUp: true },
    'æˆ°é¬¥é“å…· 300å€‹': { unit: 300, price: 10 },
    'å–µåŠ›é” 300å€‹': { unit: 300, price: 10 },
    'è²“è–„è· 20å€‹': { unit: 20, price: 10 },
    'ç¸çŸ³çµæ™¶ 20å€‹': { unit: 20, price: 10 },
    'è²“çœ¼çŸ³ 300å€‹': { unit: 300, price: 10 },
    'XPç¶“é©— 2000è¬': { unit: 20000000, price: 10 },
    'NPæœ¬èƒ½ 1è¬': { unit: 10000, price: 10 }
  };

  const imageMap = {
    '1å„„å· 1å¼µ': '1å„„å·.png',
    'éŠ€å· 300å¼µ': 'éŠ€å·.png',
    'é‡‘å· 150å¼µ': 'é‡‘å·.png',
    'ç™½é‡‘å· 3å¼µ': 'ç™½é‡‘å·.png',
    'å‚³èªªå· 1å¼µ': 'å‚³èªªå·.png',
    'é¦–é ˜æ—— 200å€‹': 'é¦–é ˜æ——.png',
    'æˆ°é¬¥é“å…· 300å€‹': 'æˆ°é¬¥é“å…·.png',
    'å–µåŠ›é” 300å€‹': 'å–µåŠ›é”.png',
    'è²“è–„è· 20å€‹': 'è²“è–„è·.png',
    'ç¸çŸ³çµæ™¶ 20å€‹': 'ç¸çŸ³çµæ™¶.png',
    'è²“çœ¼çŸ³ 300å€‹': 'è²“çœ¼çŸ³.png',
    'XPç¶“é©— 2000è¬': 'XPç¶“é©—.png',
    'NPæœ¬èƒ½ 1è¬': 'NPæœ¬èƒ½.png'
  };

  const tbody = document.getElementById('itemTable');
  Object.entries(priceTable).forEach(([name, config], index) => {
    const imgSrc = imageMap[name] || 'default.png';
    const row = document.createElement('tr');
    row.innerHTML = `
      <td><img src="images/${imgSrc}" alt="${name}" style="height: 40px; vertical-align: middle; margin-right: 8px;">${name}</td>
      <td><input type="number" min="0" data-type="portion" data-name="${name}" /></td>
      <td><input type="number" min="0" data-type="quantity" data-name="${name}" onblur="syncToPortion(this)" /></td>
    `;
    tbody.appendChild(row);
  });

  tbody.addEventListener('input', (e) => {
    const target = e.target;
    const name = target.dataset.name;
    const config = priceTable[name];
    const row = target.closest('tr');
    const portionInput = row.querySelector('[data-type="portion"]');
    const quantityInput = row.querySelector('[data-type="quantity"]');

    if (target.dataset.type === 'portion') {
      const portion = parseInt(portionInput.value) || 0;
      quantityInput.value = portion * config.unit;
    }
  });

  function syncToPortion(inputEl) {
    const row = inputEl.closest('tr');
    const name = inputEl.dataset.name;
    const config = priceTable[name];
    const qty = parseInt(inputEl.value) || 0;
    const portion = Math.ceil(qty / config.unit);
    row.querySelector('[data-type="portion"]').value = portion;
    inputEl.value = portion * config.unit;
  }

  function showToast(message) {
    const toast = document.getElementById("copyToast");
    toast.textContent = message;
    toast.style.display = "block";
    setTimeout(() => toast.style.display = "none", 2000);
  }

  function launchConfetti() {
    confetti({
      particleCount: 100,
      spread: 80,
      origin: { y: 0.6 }
    });
  }

  function calculateTotal() {
    let total = 0;
    let output = '';
    const rows = tbody.querySelectorAll('tr');
    rows.forEach(row => {
      const name = row.children[0].textContent;
      const portion = parseInt(row.children[1].children[0].value) || 0;
      const qty = parseInt(row.children[2].children[0].value) || 0;
      const config = priceTable[name];
      if (portion > 0) {
        const itemTotal = portion * config.price;
        total += itemTotal;
        output += `${name.split(' ')[0]} ${qty}ã€€ã€€${String(itemTotal).padStart(4)} å…ƒ\n`;
      }
    });
    output += "------------------------------\n";
    output += `ç¸½å…±ã€€ã€€ã€€ã€€ã€€ğŸ‘‰ ${total} å…ƒ ğŸ‘ˆ`;
    const outputBox = document.getElementById("output");
    outputBox.innerText = output;
    navigator.clipboard.writeText(output).then(() => {
      showToast("âœ… å·²è¤‡è£½å ±åƒ¹åˆ°å‰ªè²¼ç°¿");
      launchConfetti();
    });
  }
</script>
</body>
</html>
